---
title:  "[Unity ê°•ì˜] ë±€ì„œë¼ì´í¬ ê°•ì˜ - ìŠ¤í‚¬ ê°œì„  , ë§ˆë¬´ë¦¬   "
excerpt: ""

categories:
    - Class VamSurLike
tags:
    - [C#, Unity, VamSurLike]

toc: true
toc_sticky: true
 
date: 2025-03-28 05:00

---
- - -


<br>
- - - 

<!--&nbsp;ğŸ”¹ âœ” âœ…  -->


# 1. ìŠ¤í‚¬ ê°œì„ 
âœ” ê²Œì„ë§ˆë‹¤ ìŠ¤í‚¬ ì„¤ê³„ê°€ ë‹¬ë¼ì§„ë‹¤.  
âœ” FireBall.cs ì¶”ê°€ - íŒŒì´ì–´ë³¼ì„ ì£¼ê¸°ì ìœ¼ë¡œ ìƒì„±í•˜ëŠ” cs  
âœ” EgoSword - Rigidbody2D.simulateë¥¼ ê³ ì³ì„œ í‚¤ê³  ë„ë˜ë¶€ë¶„ -> íŒŒí‹°í´ ì‹œìŠ¤í…œ ì˜µì…˜ ë³€ê²½  
&nbsp;&nbsp; Play On Awake, Stop Action ìœ¼ë¡œ í‚¤ê³ ë„ëŠ” ë°©ì‹  
&nbsp;&nbsp; EgoSwordChild ì½”ë“œì‚­ì œ, Rigidbody2D ì œê±°. 
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info}  

<br><br><br><br>

# 2. ìˆ˜ì • ì½”ë“œ
ğŸ”¹ PlayerController - ìŠ¤í‚¬ê´€ë ¨ ì‚­ì œ -> Skillbookìœ¼ë¡œ, initì—ì„œ ìŠ¤í‚¬ìƒì„±, ìŠ¤í‚¬ì—ì„œ ì¨ì•¼í•  ë³€ìˆ˜ í”„ë¡œí¼í‹°  
ğŸ”¹ CreatureController init() -> ìŠ¤í‚¬ë¶ addcomponent  
ğŸ”¹ SkillBook ì¶”ê°€ ìŠ¤í‚¬ë“¤ ê´€ë¦¬, Playerì— ì»´í¬ë„ŒíŠ¸ ì¶”ê°€  
ğŸ”¹ RepeatSkill.cs ì¶”ê°€  
ğŸ”¹ FireBall.cs ì¶”ê°€ - íŒŒì´ì–´ë³¼ì„ ìƒì„±  
ğŸ”¹ Egosword ìˆ˜ì • íŒŒí‹°í´ ì‹œìŠ¤í…œì—ì„œ onoff , EgoswordcHILD ì‚­ì œ- Egoswordì—ì„œ ê´€ë¦¬  
ğŸ”¹ SkillController -> SkillBase  
ğŸ”¹ Define -> ìŠ¤í‚¬íƒ€ì… ë°˜ë³µìŠ¤í‚¬, ì—‘í‹°ë¸Œ ìŠ¤í‚¬   
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 

## Creature, Player
âœ” CreatureController initì—ì„œ ìŠ¤í‚¬ë¶ addcomponent  
âœ” PlayerController - Skillbookì—ì„œì˜ ìŠ¤í‚¬ì„ ì¶”ê°€í•˜ì—¬ ìŠ¤í‚¬ì„ ì–»ëŠ” í˜•íƒœ  
&nbsp;&nbsp;Indicator, FireSocket, ShootDir  
&nbsp;&nbsp;Skills.AddSkill ìœ¼ë¡œ ìŠ¤í‚¬ ì¶”ê°€.  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>PlayerController</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public class CreatureController : BaseController
{
    public SkillBook Skills { get; protected set; }

    public override bool Init()
    {
        base.Init();
        Skills = gameObject.GetOrAddComponent<SkillBook>();
        return true;
    }
}

public class PlayerController : CreatureController
{
    public Transform Indicator { get { return _indicator; } }
    public Vector3 FireSocket { get { return _fireSocket.position; } }
    public Vector3 ShootDir { get { return (_fireSocket.position - _indicator.position).normalized; } }

    public override bool Init()
    {
        if (base.Init() == false)
            return false;

        Skills.AddSkill<FireballSkill>(transform.position);
        Skills.AddSkill<EgoSword>(_indicator.position);

        return true;
    }
}
```
</div>
</details>

<br>

## SkillBook(SkillManager)
âœ” ìŠ¤í‚¬ë“¤ì„ ê´€ë¦¬ ë°˜ë³µìŠ¤í‚¬, ë°œë™ìŠ¤í‚¬ Listë¡œ ê´€ë¦¬  
âœ” ì—ê³ ì†Œë“œ, íŒŒì´ì–´ë³¼ ìŠ¤í‚¬ ìƒì„±, íŒŒì´ì–´ë³¼(ì˜¤ë¸Œì íŠ¸(ë¶€ëª¨) ìœ„ì¹˜ ìˆ˜ì • í•„ìš”)  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>SkillBook</summary>
<div class="notice--primary" markdown="1"> 

```c# 

public class SkillBook : MonoBehaviour
{
    // ìŠ¤í‚¬ ë§¤ë‹ˆì €.

    public List<SkillBase> Skills { get; } = new List<SkillBase>();

    public List<SkillBase> RepatedSkills { get; } = new List<SkillBase>();
    public List<SequenceSkill> SequenceSkills { get; } = new List<SequenceSkill>();

    public T AddSkill<T>(Vector3 position, Transform parent = null) where T : SkillBase 
    {
        System.Type type = typeof(T);

        if (type == typeof(EgoSword))
        {
            var egoSword = Managers.Object.Spawn<EgoSword>(position, SkillID.EGO_SWORD_ID);
            egoSword.transform.SetParent(parent);
            egoSword.ActivateSkill();

            Skills.Add(egoSword);
            RepatedSkills.Add(egoSword);
            return egoSword as T;
        }
        else if (type == typeof(FireballSkill))
        {
            var fireBall = Managers.Object.Spawn<FireballSkill>(position,ìˆ˜ì •í•„ìš”);
            fireBall.transform.SetParent(parent);
            fireBall.ActivateSkill();

            Skills.Add(fireBall);
            RepatedSkills.Add(fireBall);
            return fireBall as T;
        }
        return null;
    }
}

```
</div>
</details>

<br>

## RepeatSkill
âœ” RepeatSkill - ì½”ë£¨í‹´ìœ¼ë¡œ ì¿¨íƒ€ì„ë§ˆë‹¤ ìŠ¤í‚¬ì„ ì‹¤í–‰í•´ì£¼ëŠ” ì½”ë“œ  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>RepeatSkill</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public abstract class RepeatSkill : SkillBase
{
    public float CoolTime { get; set; } = 1.0f;

    public RepeatSkill( ) : base(SkillType.Repeat)
    {

    }

    #region CoSkill

    Coroutine _coSkill;

    public override void ActivateSkill()
    {
        if (_coSkill != null)
            StopCoroutine(_coSkill);

        _coSkill = StartCoroutine(CoStartSkill());
    }

    protected abstract void DoSkillJob();

    protected virtual IEnumerator CoStartSkill() 
    {
        WaitForSeconds wait = new WaitForSeconds(CoolTime);

        while (true) 
        {
            DoSkillJob();
            yield return wait;
        }
    }
    #endregion
}
```
</div>
</details>

<br>

## FireBall
âœ” FireBall.cs ì¶”ê°€ - íŒŒì´ì–´ë³¼ì„ ì£¼ê¸°ì ìœ¼ë¡œ ìƒì„±  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>FireballSkill</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public class FireballSkill : RepeatSkill
{
    protected override void DoSkillJob()
    {
        PlayerController pc = Managers.Game.Player;
        if (pc == null)
            return;

        Vector3 spawnPos = pc.FireSocket;
        Vector3 dir = pc.ShootDir;

        GenerateProjectile(SkillID.FIRE_BALL_ID, pc, spawnPos, dir, Vector3.zero);
       
    }
}
```
</div>
</details>

<br>

## Egosword
âœ” Egosword ìˆ˜ì • íŒŒí‹°í´ ì‹œìŠ¤í…œì—ì„œ onoff , EgoswordcHILD ì‚­ì œ- Egoswordì—ì„œ ê´€ë¦¬  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>EgoSword</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public class EgoSword : RepeatSkill
{
    [SerializeField]
    ParticleSystem[] _swingParticles;

    protected enum SwingType
    {
        First,
        Second,
        Third,
        Fourth
    }

    protected override IEnumerator CoStartSkill()
    {
        WaitForSeconds wait = new WaitForSeconds(CoolTime);

        while (true)
        {
            SetParticles(SwingType.First);
            _swingParticles[(int)SwingType.First].gameObject.SetActive(true);
            yield return new WaitForSeconds(_swingParticles[(int)SwingType.First].main.duration);

            SetParticles(SwingType.Second);
            _swingParticles[(int)SwingType.Second].gameObject.SetActive(true);
            yield return new WaitForSeconds(_swingParticles[(int)SwingType.Second].main.duration);

            SetParticles(SwingType.Third);
            _swingParticles[(int)SwingType.Third].gameObject.SetActive(true);
            yield return new WaitForSeconds(_swingParticles[(int)SwingType.Third].main.duration);

            SetParticles(SwingType.Fourth);
            _swingParticles[(int)SwingType.Fourth].gameObject.SetActive(true);
            yield return new WaitForSeconds(_swingParticles[(int)SwingType.Fourth].main.duration);

            yield return wait;
        }
    }

    public override bool Init()
    {
        base.Init();

        return true;
    }

    void SetParticles(SwingType swingType)
    {
        if (Managers.Game.Player == null)
            return;

        Vector3 tempAngle = Managers.Game.Player.Indicator.transform.eulerAngles;
        transform.localEulerAngles = tempAngle;
        transform.position = Managers.Game.Player.transform.position;

        float radian = Mathf.Deg2Rad * tempAngle.z * -1;

        var main = _swingParticles[(int)swingType].main;
        main.startRotation = radian;
    }

    private void OnTriggerEnter2D(Collider2D collision)
    {
        MonsterController mc = collision.transform.GetComponent<MonsterController>();
        if (mc.IsValid() == false)
            return;

        mc.OnDamaged(Owner, Damage);
    }

}
```
</div>
</details>

<br>

## SkillBase
ğŸ”¹ SkillBase ìŠ¤í‚¬ì˜ ê¸°ë³¸ì •ë³´ë“¤, ìŠ¤í‚¬ìƒì„±, ìŠ¤í‚¬ì‚­ì œ  
Owner, SkillType, SkillData, SkillLevel, IsLearnedSkill, Damage  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>FireballSkill</summary>
<div class="notice--primary" markdown="1"> 

```c# 
// EgoSword : í‰íƒ€
// FireProjectile : íˆ¬ì‚¬ì²´
// PoisonField : ë°”ë‹¥
public class SkillBase : BaseController
{
    public CreatureController Owner { get; set; }
    public SkillType SkillType { get; set; } = SkillType.None;
    public Data.SkillData SkillData { get; protected set; }

    public int SkillLevel { get; set; } = 0; 
    public bool IsLearnedSkill { get { return SkillLevel > 0; } }
    public int Damage { get; set; } = 100;

    public SkillBase(SkillType skillType) 
    {
        SkillType = skillType;
    }

    public virtual void ActivateSkill() { }

    protected virtual void GenerateProjectile(int templateID, CreatureController owner, Vector3 startPos, Vector3 dir, Vector3 targetPos)
    {
        ProjectileController pc = Managers.Object.Spawn<ProjectileController>(startPos, templateID);
        pc.SetInfo(templateID, owner, dir);
    }

    #region Destroy
    Coroutine _coDestroy;

    public void StartDestroy(float delaySeconds) 
    {
        StopDestroy();
        _coDestroy = StartCoroutine(CoDestroy(delaySeconds));
    }

    public void StopDestroy() 
    {
        if (_coDestroy != null)
        {
            StopCoroutine(_coDestroy);
            _coDestroy = null;
        }
    }

    IEnumerator CoDestroy(float delaySeconds)
    {
        yield return new WaitForSeconds(delaySeconds);

        if (this.IsValid())
        {
            Managers.Object.Despawn(this);
        }
    }
    #endregion
}
```
</div>
</details>

<br>

## DEFINE

<details>
<summary>DEFINE</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public enum SkillType
{
    None,
    Sequence,
    Repeat,
}
```
</div>
</details>

<br><br><br><br>

# ì˜¤ë¥˜ ìˆ˜ì •

## Player - Init()ì´ ë‘ë²ˆì‹¤í–‰  
âœ” ìŠ¤í‚¬ë“¤ 2ê°œ ì”© ìƒì„±  
âœ… Player init 2ë²ˆ => 1ë²ˆìœ¼ë¡œ ìˆ˜ì • ObjectManager - ìŠ¤í°í›„ init ì œê±°  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice} 

## FireballSkilì˜ ì˜¤ë¸Œì íŠ¸ ìœ„ì¹˜ 
âœ” FireballSkilëŠ” ë¹ˆì˜¤ë¸Œì íŠ¸ì— ìŠ¤í¬ë¦½íŠ¸ë§Œ ìˆì–´ë„ ëœë‹¤.  
âœ” ìŠ¤í‚¬ì„ì“°ëŠ” Ownerì—ê²Œ ì¶”ê°€? ìŠ¤í‚¬ê´€ë ¨ ê°•ì˜ ë‹¤ ë“¤ì–´ë³´ê³  ìˆ˜ì •.  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice} 

## FireProjectile ì‚­ì œ ì•ˆë˜ëŠ” ì˜¤ë¥˜  
âœ” SkillBaseì—ì„œ ìƒì†ë°›ì€ ê²ƒì„ ì‚¬ìš©í•˜ë ¤ê³  í•˜ë‹ˆê¹Œ  
âœ” objectManager.Despawn ì½”ë“œ ê¹Œì§€ ì‹¤í–‰ì´ ë˜ëŠ”ë° ProjectileController, SkillBase íƒ€ì…ê´€ë ¨í•´ì„œ ë¬¸ì œê°€ ìˆëŠ” ê²ƒ ê°™ë‹¤.  
âœ… ì¼ë‹¨ Projectile ì—ì„œ ì½”ë£¨í‹´ì„ ë”°ë¡œ ë§Œë“¤ì–´ì„œ ì‹¤í–‰í•´ì„œ ì˜¤ë¥˜ìˆ˜ì •. (íƒ€ì…ì„ ì²´í¬í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ í•´ê²°í•´ë³´ê¸°.)  
âœ” ë‹¤ë¥¸ì˜¤ë¥˜ poolì— ë“¤ì–´ê°”ë‹¤ê°€ ë‚˜ì˜¤ë©´ ì½”ë£¨í‹´stopë˜ì–´ì„œ ë‹¤ì‹œ ì‚­ì œê°€ ì•ˆë˜ëŠ”ë¶€ë¶„  
âœ… Onenableë¡œ ì½”ë£¨í‹´ì‹¤í–‰  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice} 

<br><br><br><br>

# ì´ê²ƒì €ê²ƒ ë©”ëª¨

## 
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice} 

<br><br><br>
- - - 

# ì¡ë‹´, ì¼ê¸°?
ê°•ì˜ ë³µìŠµ
ì½”ë“œ ë¶„ë¥˜í•˜ëŠ” ì—°ìŠµ, ìƒì†ì„¤ê³„, ìƒì†ê´€ë ¨í•´ì„œ typeì„ ì´ìš©í•˜ì—¬ í•´ê²°í•˜ëŠ”ë²•   
ì•„ì§ ìƒì†ê´€ë ¨í•´ì„œ ë¯¸ìˆ™í•œ ê²ƒ ê°™ë‹¤. ìƒì†ì— ê´€í•œ ê°•ì˜, ì—°ìŠµ ë§ì´ í•´ë³´ê¸°.  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--success}  


<br><br>
- - -