---
title:  "[Unity ê°•ì˜] ë±€ì„œë¼ì´í¬ ê°•ì˜ - ë³´ìŠ¤ ìŠ¤í‚¬ ê°œì„  "
excerpt: ""

categories:
    - Class VamSurLike
tags:
    - [C#, Unity, VamSurLike]

toc: true
toc_sticky: true
 
date: 2025-03-30 05:00

---
- - -


<br>
- - - 

<!--&nbsp;ğŸ”¹ âœ” âœ…  -->


# 1. ìŠ¤í‚¬ ê°œì„ 
âœ” SequenceìŠ¤í‚¬ - Move, Dash ì¶”ê°€  
&nbsp;&nbsp; BossController ì—ì„œ Moveë¥¼ ì œê±°í•˜ê³  Skillë¡œ í†µí•©   
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info}  

<br><br><br><br>

# 2. ìˆ˜ì • ì½”ë“œ
ğŸ”¹ SequenceSkill - ì¶”ìƒ í´ë˜ìŠ¤, DoSkill ì¶”ìƒë©”ì„œë“œ  
ğŸ”¹ Move - Targetì„ í–¥í•´ Xì´ˆ ì›€ì§ì´ëŠ” ì½”ë“œ  
ğŸ”¹ Dash - Targetì„ í–¥í•´ ëŒì§„  
ğŸ”¹ SkillBook - SequenceSkill ìˆœì°¨ì  ì‹¤í–‰  
âœ… BossController - ì´ë™ ë¶€ë¶„ ì—†ì• ê³  -> SequenceSkillë¡œ  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info}

<br>

## SequenceSkill
âœ” SequenceSkillì„ ë§Œë“¤ ë•Œ SkillTypeì„ ì„¤ì •  
âœ” Doskill() ì¶”ìƒë©”ì„œë“œ -> ìì‹ í´ë˜ìŠ¤ì— ë°˜ë“œì‹œ êµ¬í˜„  
âœ” CallBack ìœ¼ë¡œ ìŠ¤í‚¬ì´ ëë‚˜ë©´ ì¶”ê°€ ì‘ì—…ì„ ì‹¤í–‰.  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>SequenceSkill</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public abstract class SequenceSkill : SkillBase
{
    public SequenceSkill() : base(SkillType.Sequence) { } 
    public abstract void DoSkill(Action callback = null); 
}
```
</div>
</details>

<br>

## Move
âœ” ì´ë™ì„ SequenceSkillë¡œ  
âœ” elapsedê°€ ë°ì´í„° ì‹œíŠ¸ì— ìˆìœ¼ë©´ ê·¸ ë°ì´í„°ë¥¼ ì‚¬ìš©  
âœ” CoMove() elapsedì´ˆ ë™ì•ˆ Targetì„ í–¥í•´ ì´ë™  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>Move</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public class Move : SequenceSkill
{
    Rigidbody2D _rb;
    Coroutine _coroutine;

    public override void DoSkill(Action callback = null)
    {
        if (_coroutine != null)
            StopCoroutine(_coroutine);

        _coroutine = StartCoroutine(CoMove(callback));

    }

    float Speed { get; } = 2.0f;
    string AnimationName { get; } = "Moving";

    IEnumerator CoMove(Action callback = null)
    {
        _rb = GetComponent<Rigidbody2D>();
        GetComponent<Animator>().Play(AnimationName);
        float elapsed = 0; // Move ì‹œê°„

        while (true)
        {
            elapsed += Time.deltaTime;
            if (elapsed > 3.0f)
                break;

            Vector3 dir = ((Vector2)Managers.Game.Player.transform.position - _rb.position).normalized;
            Vector2 targetPosition = Managers.Game.Player.transform.position + dir * UnityEngine.Random.Range(1, 4);

            if (Vector3.Distance(_rb.position, targetPosition) <= 0.2f)
                continue;
                
            
            Vector2 dirvec = (targetPosition - _rb.position).normalized;
            Vector2 nextVec = dirvec * Speed * Time.fixedDeltaTime;
            _rb.MovePosition(_rb.position + nextVec);

            yield return null;
        }

        callback?.Invoke();
    }
}
```
</div>
</details>

<br>

## Dash
âœ” Moveì™€ ìœ ì‚¬    
âœ” Targetì„ í–¥í•´ Speedë§Œí¼ ëŒì§„    
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>Dash</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public class Dash : SequenceSkill
{
    Rigidbody2D _rb;
    Coroutine _coroutine;

    public override void DoSkill(Action callback = null)
    {
        if (_coroutine != null)
            StopCoroutine(_coroutine);

        _coroutine = StartCoroutine(CoDash(callback));
        
    }

    float WaitTime { get; } = 1.0f;
    float Speed { get; } = 10.0f;
    string AnimationName { get; } = "Charge";

    IEnumerator CoDash(Action callback = null) 
    {
        _rb = GetComponent<Rigidbody2D>();

        yield return new WaitForSeconds(WaitTime);

        GetComponent<Animator>().Play(AnimationName);

        Vector3 dir = ((Vector2)Managers.Game.Player.transform.position - _rb.position).normalized;
        Vector2 targetPosition = Managers.Game.Player.transform.position + dir * UnityEngine.Random.Range(1, 5);


        while (Vector3.Distance(_rb.position, targetPosition) > 0.2f)
        {
            Vector2 dirvec = (targetPosition - _rb.position).normalized;
            Vector2 nextVec = dirvec * Speed * Time.fixedDeltaTime;
            _rb.MovePosition(_rb.position + nextVec);

            yield return null;
        }

        callback?.Invoke();
    }
}
```
</div>
</details>

<br>

## SkillBook
âœ” SequenceSkill AddSkill ì¶”ê°€  
âœ” SequenceìŠ¤í‚¬ ëª©ë¡ì„ ìˆœì„œëŒ€ë¡œ ë°œë™  
âœ… StartNextSequenceSkill() í˜„ì¬ ìŠ¤í‚¬ ë°œë™  
âœ… OnFinishedSequenceSkill  ë‹¤ìŒìŠ¤í‚¬Indexë¡œ ë³€ê²½  
âœ… StopSkills() ëª¨ë“  RepeatSkill ë©ˆì¶¤  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>SkillBook</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public class SkillBook : MonoBehaviour
{
    // ìŠ¤í‚¬ ë§¤ë‹ˆì €.
    public List<SkillBase> Skills { get; } = new List<SkillBase>();
    public List<SkillBase> RepeatedSkills { get; } = new List<SkillBase>();
    public List<SequenceSkill> SequenceSkills { get; } = new List<SequenceSkill>();

    public T AddSkill<T>(Vector3 position, Transform parent = null) where T : SkillBase 
    {
        System.Type type = typeof(T);

        else if (type.IsSubclassOf(typeof(SequenceSkill)))
        {
            var skill = gameObject.GetOrAddComponent<T>();
            Skills.Add(skill);
            SequenceSkills.Add(skill as SequenceSkill);

            return skill as T;
        }

        return null;
    }

    int _sequenceIndex = 0;
    //âœ… StartNextSequenceSkill() í˜„ì¬ ìŠ¤í‚¬ ë°œë™  
    public void StartNextSequenceSkill() 
    {
        if (_stopped)
            return;
        if (SequenceSkills.Count == 0)
            return;

        SequenceSkills[_sequenceIndex].DoSkill(OnFinishedSequenceSkill);
    }
    //âœ… OnFinishedSequenceSkill  ë‹¤ìŒìŠ¤í‚¬Indexë¡œ ë³€ê²½  

    void OnFinishedSequenceSkill() 
    {
        _sequenceIndex = (_sequenceIndex + 1) % SequenceSkills.Count;
        StartNextSequenceSkill();
    }


    bool _stopped = false;
    //âœ… StopSkills() ëª¨ë“  RepeatSkill ë©ˆì¶¤  
    public void StopSkills() 
    {
        _stopped = true;

        foreach (var skill in RepeatedSkills)
        {
            skill.StopAllCoroutines();
        }
    }
}
```
</div>
</details>

<br>

## BossController
âœ” SequenceSkill Move - Dash - Dash - Dash ìˆœì„œë¡œ ì¶”ê°€
âœ” ìŠ¤í‚¬ ìƒíƒœë¡œ ë“¤ì–´ê°€ë©´ StartNextSequenceSkillë¥¼ í•˜ë©´ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--info} 
<details>
<summary>BossController</summary>
<div class="notice--primary" markdown="1"> 

```c# 
public class BossController : MonsterController
{
    public override bool Init()
    {
        base.Init();

        _animator = GetComponent<Animator>();
        //CreatureState = CreatureState.Moving;
        Hp = 1000000;

        CreatureState = CreatureState.Skill;

        Skills.AddSkill<Move>(transform.position);
        Skills.AddSkill<Dash>(transform.position);
        Skills.AddSkill<Dash>(transform.position);
        Skills.AddSkill<Dash>(transform.position);
        //Skills.StartNextSequenceSkill();

        return true;
    }
}
```
</div>
</details>


<br><br><br><br>

# ì´ê²ƒì €ê²ƒ ë©”ëª¨

## ê³µí†µì ì¸ ë¶€ë¶„ -> ë°ì´í„°  
ì—¬ëŸ¬ ìŠ¤í‚¬ ë§Œë“¤ë‹¤ë³´ë©´ ê³µí†µì ì¸ë¶€ë¶„ => í†µí•©í•´ì„œ ë°ì´í„°ì‹œíŠ¸ë¡œ  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice} 

## ì¹´ë©”ë¼ ì‹œì  ë³€í™˜ 
ì¹´ë©”ë¼ ì‹œì  ë³€í™˜ë„ ë°ì´í„° ì‹œíŠ¸ë¡œ?  
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice} 

<br><br><br>
- - - 

# ì¡ë‹´, ì¼ê¸°?
{:style="border:1px solid #EAEAEA; border-radius: 7px;"}
{: .notice--success}  


<br><br>
- - -